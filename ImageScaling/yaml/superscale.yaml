!obj:pylearn2.train.Train {
   "dataset": &train !pkl: "dataset_app.pkl",
   "model": !obj:pylearn2.models.mlp.MLP {
      "layers": [
         !obj:pylearn2.models.mlp.Sigmoid {
            layer_name: 'h1',
            dim: 800,
            sparse_init: 15,
          },
         !obj:pylearn2.models.mlp.Sigmoid {
            layer_name: 'y',
            dim: 1600,
            sparse_init: 15,
         }
      ],
      "nvis": 1024,
   },
   "algorithm": !obj:pylearn2.training_algorithms.sgd.SGD {
      "learning_rate" : 0.1,
      "batch_size" : 5, #mettre 1 a la place 
      "monitoring_batches" : 5,
      "monitoring_dataset": {
         "train": *train,
         "valid": !pkl: "dataset_val.pkl",
      },
      "termination_criterion": !obj:pylearn2.termination_criteria.EpochCounter {
         "max_epochs": 300,
      },
   },
   "extensions": [
      !obj:pylearn2.train_extensions.best_params.MonitorBasedSaveBest {
         "channel_name": 'valid_objective',
         "save_path": "./mlp_best.pkl"
      },
   ]
}
