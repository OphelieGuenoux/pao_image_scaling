!obj:pylearn2.train.Train {
   "dataset": &train !pkl: "dataset_app.pkl",
   "model": !obj:pylearn2.models.mlp.MLP {
      "layers": [
         !obj:pylearn2.models.mlp.Sigmoid {
            layer_name: 'h1',
            dim: 82,
            irange: 1.,
          },
         !obj:pylearn2.models.mlp.Sigmoid {
            layer_name: 'y',
            dim: 100,
            irange: 1.,
         }
      ],
      "nvis": 64,
   },
   "algorithm": !obj:pylearn2.training_algorithms.sgd.SGD {
      "learning_rate" : 0.001,
      "batch_size" : 1,
      "monitoring_batches" : 1,
      "monitoring_dataset": {
         "train": *train,
         "valid": !pkl: "dataset_val.pkl",
      },
      "termination_criterion": !obj:pylearn2.termination_criteria.EpochCounter {
         "max_epochs": 1000,
      },
   },
   "save_path": "./model_fin.pkl",
   "save_freq": 1,
   "extensions": [
      !obj:pylearn2.train_extensions.best_params.MonitorBasedSaveBest {
         "channel_name": 'valid_objective',
         "save_path": "./mlp_best.pkl"
      },
      !obj:pylearn2.training_algorithms.sgd.LinearDecayOverEpoch {
         "start" : 4,
         "saturate" : 30,
         "decay_factor" : 0.0001
      },
      !obj:pylearn2.train_extensions.live_monitoring.LiveMonitoring {},
   ]
}
